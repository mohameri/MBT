{{- if not (.Param "hideFooter") }}
<style>
    /* =========================================
       1. الإطار العام للفوتر والمساحات (كمبيوتر)
       ========================================= */
    .modern-footer {
        background-color: #2a2a2a; 
        border-top: 1px solid #3d3d3d;
        padding: 120px 20px 50px; 
        color: #ffffff;
        font-family: inherit;
        text-align: center;
        direction: rtl;
    }

    .footer-cta {
        margin-bottom: 100px; 
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    
    .footer-logo-img {
        width: 260px; 
        margin-bottom: 40px; 
        pointer-events: none;
        filter: drop-shadow(0 0 12px rgba(0,0,0,0.25)); 
    }

    .footer-main-title {
        font-size: clamp(1.1rem, 2.5vw, 1.6rem); 
        font-weight: 900;
        margin: 0 0 30px 0;
        line-height: 1.5;
    }

    /* التنسيق الجديد للعنوان */
    .text-hover-gold { 
        color: #ffffff; 
        transition: color 0.3s ease; 
        cursor: default; 
    }
    .text-hover-gold:hover, .text-hover-gold:active { 
        color: #e1c443; 
    }
    
    /* اللون الأصفر (الذهبي) المخصص للكلمة المطلوبة */
    .text-always-gold { 
        color: #e1c443; 
    }

    .footer-cta-btn {
        display: inline-block;
        padding: 15px 45px;
        background-color: #1f3264; 
        color: #ffffff; 
        border: 1px solid #1f3264;
        border-radius: 8px;
        text-decoration: none;
        font-size: 1.05rem;
        font-weight: bold;
        transition: all 0.3s ease;
    }

    .footer-cta-btn:hover {
        background-color: #e1c443;
        color: #1f3264;
        border-color: #e1c443;
        transform: translateY(-3px);
    }

    .footer-subscribe-wrapper {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        align-items: center;
        gap: 40px; 
        max-width: 1100px;
        margin: 0 auto 70px; 
        text-align: right;
        border-top: 1px solid #444444; 
        border-bottom: 1px solid #444444;
        padding: 70px 0; 
    }

    .subscribe-text h3 { font-size: 1.5rem; font-weight: 800; margin: 0 0 10px 0; color: #ffffff; }
    .subscribe-text p { color: #bbbbbb; font-size: 0.95rem; margin: 0; line-height: 1.5; }

    .subscribe-form { display: flex; gap: 15px; width: 100%; max-width: 500px; }
    .subscribe-form input { flex: 1; padding: 15px 20px; border-radius: 8px; border: 1px solid #555; background: #404040; color: #ffffff; font-family: inherit; outline: none; }
    .subscribe-form input:focus { border-color: #1f3264; }
    .subscribe-form button { padding: 15px 30px; background: #1f3264; color: #ffffff; border: none; border-radius: 8px; font-family: inherit; font-weight: bold; cursor: pointer; transition: all 0.3s; }
    .subscribe-form button:hover { background: #e1c443; color: #1f3264; }

    .footer-bottom {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        align-items: center;
        max-width: 1100px;
        margin: 0 auto;
        color: #999999;
        font-size: 0.9rem;
    }

    .footer-socials { display: flex; gap: 25px; font-weight: bold; }
    .footer-socials a { color: #bbbbbb; text-decoration: none; transition: all 0.3s; }
    .footer-socials a:hover { color: #e1c443; transform: translateY(-3px); }

    /* =========================================
       2. تحسينات مخصصة للهاتف
       ========================================= */
    @media (max-width: 768px) {
        .modern-footer {
            padding: 50px 15px 120px; 
        }
        .footer-cta { margin-bottom: 40px; }
        .footer-logo-img { width: 180px; margin-bottom: 25px; }
        .footer-main-title { font-size: 1.2rem; margin-bottom: 30px; }
        .footer-subscribe-wrapper {
            flex-direction: column;
            gap: 35px;
            padding: 40px 0;
            margin-bottom: 40px;
        }
        .subscribe-form { flex-direction: column; width: 100%; }
        .footer-bottom {
            flex-direction: column-reverse; 
            gap: 25px;
            padding-top: 10px;
        }
    }
</style>

<footer class="modern-footer">
    
    <div class="footer-cta">
        <img src="/images/logo.png" alt="شعار MBT" class="footer-logo-img">
        <h2 class="footer-main-title">
            <span class="text-hover-gold">دعنا نناقش كيف يمكننا </span><span class="text-always-gold">تطوير علامتك التجارية</span>
        </h2>
        <a href="https://wa.me/9647872840590" target="_blank" class="footer-cta-btn">تواصل معنا الآن</a>
    </div>

    <div class="footer-subscribe-wrapper">
        <div class="subscribe-text">
            <h3>نشرة MBT البريدية</h3>
            <p>أحدث استراتيجيات بناء العلامات التجارية وصناعة المحتوى في صندوق واردك.</p>
        </div>
        <div class="subscribe-form">
            <input type="email" placeholder="أدخل بريدك الإلكتروني..." required>
            <button type="submit">اشترك معنا</button>
        </div>
    </div>

    <div class="footer-bottom">
        <div class="copyright">
            &copy; {{ now.Year }} MBT.
        </div>
        <div class="footer-socials">
            <a href="https://instagram.com/mbt_ad" target="_blank">Instagram</a>
            <a href="https://facebook.com/mbt.advertising" target="_blank">Facebook</a>
            <a href="https://wa.me/9647872840590" target="_blank">WhatsApp</a>
        </div>
    </div>

</footer>
{{- end }}

{{- if (not site.Params.disableThemeToggle) }}
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
{{- end }}

{{- if (and (eq .Kind "page") (ne .Layout "archives") (ne .Layout "search") (.Param "ShowCodeCopyButtons")) }}
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '{{- i18n "code_copy" | default "copy" }}';

        function copyingDone() {
            copybutton.innerHTML = '{{- i18n "code_copied" | default "copied!" }}';
            setTimeout(() => {
                copybutton.innerHTML = '{{- i18n "code_copy" | default "copy" }}';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            // td containing LineNos
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            // table containing LineNos and code
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            // code blocks not having highlight as parent class
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
{{- end }}
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // 1. تعريف عناصر التحكم
        const currencySelector = document.getElementById("currency-selector");
        const priceElements = document.querySelectorAll(".price-display");

        // تأكد من وجود القائمة قبل تشغيل الكود لتجنب الأخطاء
        if (!currencySelector) {
            console.error("خطأ: لم يتم العثور على قائمة العملات (ID: currency-selector)");
            return;
        }

        // 2. أسعار الصرف (تأكد من تحديثها)
        const rates = {
            "IQD": 1,         // الأساس
            "USD": 1300,      // سعر الدولار (قسمة)
            "AED": 355,        // سعر الدرهم (قسمة)
			"SAR": 384
        };

        // 3. الدالة الرئيسية
        function updatePrices() {
            const selected = currencySelector.value;
            console.log("تم اختيار العملة:", selected); // للتجربة

            priceElements.forEach(el => {
                // تنظيف الرقم من أي فواصل قد تكون كتبت بالخطأ
                let rawPrice = el.getAttribute("data-base-price").replace(/,/g, ''); 
                let basePrice = parseFloat(rawPrice);

                let finalPrice = 0;
                let symbol = "";

                if (selected === "IQD") {
                    finalPrice = basePrice;
                    symbol = " د.ع";
                } else if (selected === "USD") {
                    finalPrice = basePrice / rates.USD;
                    symbol = " $";
                } else if (selected === "AED") {
                    finalPrice = basePrice / rates.AED;
                    symbol = " د.إ";
				} else if (selected === "SAR") {  // <--- هذا الشرط كان ناقصاً وهو سبب الصفر!
                    finalPrice = basePrice / rates.SAR;
                    symbol = " ر.س";	
                }

                // التحديث في الصفحة (بدون كسور)
                el.innerText = Math.round(finalPrice).toLocaleString() + symbol;
            });

            // حفظ الاختيار
            localStorage.setItem("userCurrency", selected);
        }

        // 4. ربط الأحداث (تشغيل الكود عند التغيير)
        currencySelector.addEventListener("change", updatePrices);

        // 5. استرجاع الاختيار القديم عند التحميل
        const savedCurrency = localStorage.getItem("userCurrency");
        if (savedCurrency) {
            currencySelector.value = savedCurrency;
        }
        
        // تحديث أولي
        updatePrices();
    });
</script>